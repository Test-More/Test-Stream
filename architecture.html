<dl class="listnav">
    <dt id="philosophy">Philosophy</dt>
    <dd>
        <h2>Philosophy behind the Test-Stream architecture</h2>
        <ul>
            <li>Never assume you know what people will need.</li>
            <li>Provide tools to build solutions, not prepackages solutions.</li>
            <li>Keep the interface as simple as possible.</li>
            <li>Hooks are better than predictions.</li>
            <li>Avoid lock-in to limited ideas.</li>
            <li>Be strict with new features, relax them if necessary.</li>
        </ul>
    </dd>

    <dt id="overview">Overview</dt>
    <dd>
        <h2>Overview</h2>
        <dl class="descriptive_points">
            <dt>Event Objects</dt>
            <dd>'ok', 'diag', etc, are all event objects that get passed around once created.</dd>

            <dt>Hubs</dt>
            <dd>Hubs recieve events, process them, update state, and finally pass them off to a formatter.</dd>

            <dt>IPC</dt>
            <dd>Concurrency is handled by an IPC driver that passes events between threads and processes.</dd>

            <dt>Hub Stack</dt>
            <dd>Hubs are not singletons, they usually belong to one or more hub stacks.</dd>

            <dt>Sync</dt>
            <dd>Ultimately some state must be universally shared, that is done in the Test::Stream::Sync package.</dd>

            <dt>Context</dt>
            <dd>The context is your map, compass and gps. It tracks file+line
            numbers, what hub to use, and is the primary interface for
            generatign events.</dd>
        </dl>
    </dd>

    <dt id="events">Events</dt>
    <dd>
        <h2>Test-Stream is an event driven system</h2>

        Instead of assuming people want to take a limited set of actions that
        always boil down to TAP, Test::Stream uses an extendable event system.

        <ul>
            <li>Test tools are event producers</li>
            <li>Test-Stream routes the events</li>
            <li>Formatters turn the events into TAP, or other formats as needed</li>
            <li>There are several hooks in the event pipeline</li>
        </ul>

        <p>

        All the actions you know and love from Test-Builder are now proper
        event objects:
        <ul class="horizontal_list">
            <li>Ok</li>
            <li>Diag</li>
            <li>Note</li>
            <li>Plan</li>
            <li>Bail</li>
            <li>Subtest</li>
        </ul>
        You can also add your own event types as needed!
    </dd>

    <dt id="hubs">Hubs</dt>
    <dd>
        <h2>Hubs route events while maintaining state</h2>

        The hub is the component of Test-Stream that recieves events, processes
        them, and send them to the formatter.

        <ul>
            <li>Test state is updated as events pass through the hub.</li>
            <li>The hub provides hooks to manipulate events.</li>
            <li>The hub handles IPC for events in concurrent testing.</li>
            <li>Not a singleton, there can be several hubs at any given time.</li>
        </ul>

        The hub package is as simple as it can be. Keeping hubs simple is
        essential for performance.
    </dd>

    <dt id="hub_stack">Hub Stack</dt>
    <dd>
        <h2>The hub stack manages hubs</h2>

        <ul>
            <li>Events always go to the top hub in the stack.</li>
            <li>You can push and pop hubs as needed.</li>
            <li>The hub stack is what makes subtests sane.</li>
            <li>The hub stack is what makes test tool testing possible.</li>
            <li>The hub stack is not a singleton*.</li>
            <li>Test::Builder uses additional stacks for some features.</li>
        </ul>

        <small>* There is a shared/canon instance.</small>
    </dd>

    <dt id="sync">Sync</dt>
    <dd>
        <h2>Test::Stream::Sync, Where shared state lives</h2>

        This is the closest thing to a singleton that you will find in Test::Stream.

        <ul>
            <li>Holds the canonical hub stack for all to find.</li>
            <li>Holds the canonical IPC driver instance.</li>
            <li>Handles the END logic that sets the exit code if there is a problem.</li>
            <li>Makes sure child threads/procs end before the main thread/proc.</li>
            <li>Provides hooks into the END process.</li>
            <li>Provides global context hooks.</li>
        </ul>
    </dd>

    <dt id="context">Context</dt>
    <dd>
        <h2>Context: map, compass, gps, teleporter, primary API</h2>

        Context objects are where most test tool authors will interact with
        Test::Stream.

        <ul>
            <li>One instance per hub.</li>
            <li>Each tools gets its own.</li>
            <li>Tools called within other tools inherit their parents context</li>
            <li>Primary interface for generating events.</li>
            <li>Tracks which hub should be used.</li>
            <li>Track filename and line number for reporting.</li>
        </ul>
    </dd>
</dl>
